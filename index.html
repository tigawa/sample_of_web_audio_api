<html lang="ja">
<head>
<meta charset="UTF-8">
<script type="text/javascript">
    var context;
    var soundBuffer = {};
    
    window.addEventListener('load', init, false);
    function init() {
        try {
            context = new webkitAudioContext();
            loadDogSound('key_down', "audio/key_down.mp3");
            loadDogSound('enter', "audio/enter.mp3");
          
            /* keybrodを押した時の処理 */
            document.addEventListener("keydown", 
                function(ev){
                    if ( ev.keyCode == 13 )
                        playSound(soundBuffer.enter);
                    else
                        playSound(soundBuffer.key_down);
                }, false);
                        

        } catch(e) {
            alert('Web Audio API is not supported in this browser');
        }
    }
    
    function loadDogSound(key, url) {
        var request = new XMLHttpRequest();
        request.open('GET', url, true);
        request.responseType = 'arraybuffer';

        // Decode asynchronously
        request.onload = function() {
        context.decodeAudioData(request.response,
                                /* デコードが完了したときに実行される処理 */
                                function(buffer) { soundBuffer[key] = buffer;},
                                /* デコードが失敗したときに実行される処理 */
                                function(){alert("error")});
        }
        request.send();
    }
    
    function playSound(buffer) {
        var source = context.createBufferSource(); // creates a sound source
        source.buffer = buffer;                    // tell the source which sound to play
        source.connect(context.destination);       // connect the source to the context's destination (the speakers)
        source.noteOn(0);                          // play the source now
    }
</script>
</head>
<body>
<textarea style="width:500; height:500" placeholder="ここにタイプしてください。"></textarea>
<!--]

<div><button id="play" >再生</button></div>-->
</body>
</html>