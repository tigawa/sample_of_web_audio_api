<html lang="ja">
<head>
<meta charset="UTF-8">
<script type="text/javascript">
    var context;
    var enterSoundBuffer = null;
    var anykeySoundBuffer = null;
    
    window.addEventListener('load', init, false);
    function init() {
      try {
        context = new webkitAudioContext();
        loadDogSound("se_maoudamashii_se_pc03.mp3");

        /* ボタンのクリック処理 */
//        var btnPlay = document.getElementById("play");
//        btnPlay.addEventListener("click", function(){playSound(anykeySoundBuffer);} , false);
          
        /* keybrodを押した時の処理 */
        document.addEventListener("keydown", function(){playSound(anykeySoundBuffer);} , false);

      } catch(e) {
        alert('Web Audio API is not supported in this browser');
      }
    }
    
   function loadDogSound(url) {
      var request = new XMLHttpRequest();
      request.open('GET', url, true);
      request.responseType = 'arraybuffer';

      // Decode asynchronously
      request.onload = function() {
        context.decodeAudioData(request.response, 
                                /* デコードが完了したときに実行される処理 */
                                function(buffer) { anykeySoundBuffer = buffer;},
                                /* でコードが失敗したときに実行される処理 */
                                function(){alert("error")});
        }
      request.send();
    }
    
    function playSound(buffer) {
      var source = context.createBufferSource(); // creates a sound source
      source.buffer = buffer;                    // tell the source which sound to play
      source.connect(context.destination);       // connect the source to the context's destination (the speakers)
      source.noteOn(0);                          // play the source now
    }
</script>
</head>
<body>
<textarea style="width:500; height:500"></textarea>
<!--]

<div><button id="play" >再生</button></div>-->
</body>
</html>